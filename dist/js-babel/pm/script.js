"use strict";$(function(){function a(a){return a.originalEvent&&a.originalEvent.touches}function b(a){return physii.math.loneRanger(a,-Math.PI,Math.PI,0,2*Math.PI)}function c(a){var c=b(a);return c=physii.math.loneRanger(c,Math.PI/4,7*Math.PI/4,0,1),c}function d(a){var b=physii.math.loneRanger(a,0,1,Math.PI/4,7*Math.PI/4),c=physii.math.loneRanger(b,0,2*Math.PI,-Math.PI,Math.PI);return c}function f(a,b){if(i){var d=i,e=d.width(),f=d.height(),j=0,k=0,l=d[0].getBoundingClientRect(),e=l.width,f=l.height,m=d.offset();j=a-(m.left+e/2),k=b-(m.top+f/2);var n=-k,o=j,p=Math.atan2(o,n),q=c(p);g(d.attr("id"),q),p>3*Math.PI/4?p=3*Math.PI/4:p<-3*Math.PI/4&&(p=-3*Math.PI/4),d.css("transform","translate(-50%, 0%)  rotate("+p+"rad)")}}function g(a,b){n.setItem(a,JSON.stringify(b)),m&&(console.log(a),"pm-control-uppers"===a&&(b=physii.math.loneRanger(b,0,1,.6,1),b=Math.pow(2,-10*(1-b))),m.handleFloat(a,b))}function h(a){var b=JSON.parse(n.getItem(a));return b}var i=null,j=$(".rotatable"),k=0,l=0,m=window.PeaceMachineInterface||pMachine.audio,n=window.localStorage;j.bind("mousedown touchstart",function(a){a.stopPropagation(),a.preventDefault(),i=$(a.target)}),j.bind("mouseout touchend",function(a){a.stopPropagation()}),$("#pm-screen-background").bind("mouseout",function(a){a.stopPropagation()}),$(document.body).bind("mousemove touchmove",function(b){var c=b;a(b)&&(c=b.originalEvent.touches[0]),k=c.pageX,l=c.pageY,f(k,l),b.stopPropagation()}),$(document.body).bind("mouseup mouseout",function(){i=null}),function(){for(var a=["pm-control-uppers","pm-control-downers"],b=0;b<a.length;b++){var c=a[b],e=$("#"+c),f=h(c),g=d(f);e.css("transform","translate(-50%, 0%)  rotate("+g+"rad)"),m&&m.handleFloat(c,f)}}()});