'use strict';var pMachine=pMachine||{};(function(a){function b(a){return a.originalEvent&&a.originalEvent.touches}function c(a){return physii.math.loneRanger(a,-Math.PI,Math.PI,0,2*Math.PI)}function d(a){var b=c(a);return b=physii.math.loneRanger(b,Math.PI/4,7*Math.PI/4,0,1),b}function e(a){var b=physii.math.loneRanger(a,0,1,Math.PI/4,7*Math.PI/4),c=physii.math.loneRanger(b,0,2*Math.PI,-Math.PI,Math.PI);return c}function f(a,b){if(o){var c=o,e=c.width(),f=c.height(),g=0,j=0,k=c[0].getBoundingClientRect(),e=k.width,f=k.height,m=c.offset();g=a-(m.left+e/2),j=b-(m.top+f/2);var n=-j,p=g,q=Math.atan2(p,n),r=d(q),s=c.attr("id");if("pm-control-uppers"===s){var t=physii.math.loneRanger(r,0,1,-30,0);r=i(t)}l(s,r),q>3*Math.PI/4?q=3*Math.PI/4:q<-3*Math.PI/4&&(q=-3*Math.PI/4),c.css("transform","translate(-50%, -50%)  rotate("+q+"rad)")}}function g(){h()||$(".web-show").css("display","");for(var a=["pm-control-uppers","pm-control-downers"],b=0;b<a.length;b++){var c=a[b],d=$("#"+c),f=m(c);r&&r.handleFloat(c,f,1),"pm-control-uppers"===c&&(f=j(f,-30,0));var g=e(f);d.css("transform","translate(-50%, -50%)  rotate("+g+"rad)")}}function h(){return"PeaceMachineInterface"in window}function i(a){var b=Math.pow(10,a/20);return b}function j(a,b,c){var d=k(a);return d=physii.math.loneRanger(d,b,c,0,1),d}function k(a){return 20*Math.log10(a)}function l(a,b){s.setItem(a,JSON.stringify(b)),r&&r.handleFloat(a,b,.01)}function m(a){var b=JSON.parse(s.getItem(a));return b}function n(){u&&u.destroy(),u=new Swiper(".swiper-container",{direction:"horizontal",autoHeight:!0,pagination:{el:".swiper-pagination"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),u.on("slideChange",function(){console.log("slide changed",u.realIndex,a.config.vibes[u.realIndex]);var b=a.config.vibes[u.realIndex];r.selectVibe(b.id)})}a.config={default_vibe:"beige_haze",vibes:[{id:"beige_haze",text:"Beige Haze",img:"sunset-1.jpg",audio:"beige_haze"},{id:"ocean_beach",text:"Ocean Beach",img:"beach.jpg",audio:"ocean-1.wav"},{id:"zabriskie_point",text:"Zabriskie Point",img:"desert.jpg",audio:"desert-loop-1.wav"},{id:"rabbit_hole",text:"Rabbit Hole",img:"garden.jpg",audio:"forest-ambient-loop-1.wav"},{id:"bummer_trip",text:"Bummer Trip",img:"bummer-trip.jpg",audio:"bummer-trip-1.wav"}]};var o=null,p=0,q=0,r=window.PeaceMachineInterface||pMachine.audio,s=window.localStorage,t=null;$(function(){t=$(".rotatable"),t.bind("mousedown touchstart",function(a){a.stopPropagation(),a.preventDefault(),o=$(a.target)}),t.bind("touchend",function(a){a.stopPropagation(),o=null}),$(document.body).bind("mousemove touchmove",function(a){var c=a;b(a)&&(c=a.originalEvent.touches[0]),p=c.pageX,q=c.pageY,f(p,q),a.stopPropagation()}),$(document.body).bind("mouseup mouseleave",function(){o=null})}),a.turnOn=function(){r.turnOn(),g();var a=$(".pm-landing");a.fadeOut(1e3,function(){a.hide()})},a.handleTurnOn=function(){r.selectVibe(a.config.default_vibe)},a.dropOut=function(){r.turnOff();var a=$(".pm-landing");a.fadeIn(1600,function(){a.show()})};var u=null;a.tuneIn=function(){var a=$(".pm-landing"),b=$(".pm-tune-in");b.fadeIn(1e3,function(){b.show(),a.hide(),n()})},a.tuneOut=function(){var a=$(".pm-tune-in");a.fadeOut(1600,function(){a.hide()})},a.getVibesConfig=function(){return JSON.stringify(a.config.vibes)},g()})(pMachine);